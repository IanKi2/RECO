## Спецификация алгоритма "ДАЕШЬ ОПТИМАЛЬНУЮ ЗАГРУЗКУ"

### Общее описание мира
1. Игровое поле — это гексагональная 2D-карта.
2. Существуют следующие типы: пустой, грязь, камень, кислота, муравейник
3. у нас есть 3 клетки муровейника 1 основнвя 2 дополнительные 
 - Свойства основного гекса:
  -  каждый ход создаёт одного юнита.
  -  имеет радиус обзора 2 гекса.
  -  Все три координаты гексов муравейника указаны в поле “home”. Какая из них является основной можно понять по полю “spot”.
 - Свойства всех гексов:
  -  генерируют и хранят нектар. Каждый гекс имеет раздельное хранение.
  -  каждый вражеский юнит получает 20 урона каждый ход в радиусе 2-х гексов. Один юнит может получить урон только от одного гекса за один ход.
4. Существует три типа юнитов
5. Каждый юнит имеет определенное количество очков передвижения (ОП), они тратятся при передвижении юнита с гекса на гекс. Количество ОП, необходимых для перемещения на гекс, зависят от типа этого гекса.
 - Ограничения:
   - Нельзя зайти на гекс, где есть чужой юнит.
   - Нельзя зайти на гекс, где есть дружественный юнит того же типа.
6. На одном гексе могут находиться только ресурсы одного типа.
7. Юнит не может переносить несколько типов ресурсов одновременно.
8. Столбцы - q. Строки - r
9. Сетка координат odd-r horizontal layout shoves odd rows right
10. Ограничение РПС — 3 запроса в секунду.
11. Если на примыкающих гексах по завершению хода находятся юниты разных команд, они атакуют друг друга. Цель выбирается рандомно.
12. Игрок может совершить набег на чужой муравейник, чтобы украсть ресурсы, находящиеся в нём.
13. для сбора клеток и для их разгрузки необходимо находитмя на этой клетке к концу хода
14. Есть несколько видов ресурсов с разной ценностью
15. Все муровьи имеют лимит загрузки


### Порядок обрабоок хода 
2. Рандомизация хода команд — строится очередь команд для последующих действий.
4. Остальные действия юнитов — по порядку из п.2 все юниты совершают передвижение, сбор ресурсов
5. Создание новых юнитов — появляется один муравей в муравейнике.
6. Генерация ресурсов — появляются случайным образом на карте.

### Передвижение юнита
1. Юнит поочередно совершает движение с гекса на гекс и, если по какой-либо причине не сможет переместиться на следующий в очереди гекс, останется на текущем
```
Пример:
Игрок 1 задал путь к указанному целевому гексу А.
Игрок 2 задал путь к указанному целевому гексу В.
Гекс В расположен по пути, указанному игроком 1.
В результате рандомного выбора игрок 2 получил приоритет передвижения в этом ходе.
В итоге юнит игрока 2 переместится на гекс В, в то время как юнит игрока 1 остановится перед гексом В не достигнув целевого гекса А.
```


### Таблица типов гексов
| Название   | Константа | Стоимость ОП |
|------------|-----------|--------------|
| Муравейник(все муровейникиб наш тот что на home) | 1         | 1            | 
| Пустой     | 2         | 1            |
| Грязь      | 3         | 2            |
| Кислота    | 4         | 1            |
| Камни      | 5         | ∞ (1000)     |

### Таблица типов ресурсов
| Название | Константа |Цена      |
|----------|-----------|----------|
| Яблоко   | 1         | 10       |
| Хлеб     | 2         |  20      |
| Нектар   | 3         |    60    |


### Таблица юнитов
| Название | Константа |   ОП        | Грузоподьемность |
|----------|-----------|-------------|------------------|
| Разведчик| 2         | 7           |  2               |
| Боец     | 1         | 4           |   2              |
| Рабочий  | 0         | 5           |   8              |

### Общее описание алгоритма
Простой и эффективный алгоритм для игры DatsPulse, где каждый муравей действует независимо по принципу:
1. Если несет ресурсы - беги домой (> 0)(только развкдчики и рабочии)
2. Если видишь ресурс - беги к нему (< 0)(только развкдчики и рабочии)
3. Иначе - удаляемся от муровейника 
4. Вражеские муровейники обходим на растоянии 2 гекса 
5. Дистанцию хода определяем по очкам перемещения ОП
6. в POST /api/move нужно отапрвыить весь просчитыный маршрут для каждого юнита
7. Обороняем собственный муровейник расроложим вокруг муровейника по бойцу (например для из перемещения можео импользовать сам муровкйник, и из него вставать на охраняемые клктки если все охроняемые клетки заняты ожидаем, развкдчики и рабочии спокойно будут проходить через бойцов) 
и того три гекса муровьев охраняет плотная стена бойцов по пириметру
8. Всегда ищем ближайший и ценнейший ресурс
9. учитываем грущоподьемность чтобы делать оптимальный выбор груза


#### GET /api/arena
**Ответ:**
```json
{
  "ants": [
    {
      "food": {"amount": 0, "type": 0},
      "health": 100,
      "id": "uuid",
      "q": 10,
      "r": 20,
      "type": 0
    }
  ],
  "enemies": [
    {
      "attack": 0,
      "food": {"amount": 0, "type": 0},
      "health": 0,
      "q": 10,
      "r": 20,
      "type": 1
    }
  ],
  "food": [
    {
      "amount": 0,
      "q": 10,
      "r": 20,
      "type": 0
    }
  ],
  "home": [{"q": 10, "r": 20}],
  "map": [
    {
      "cost": 1,
      "q": 10,
      "r": 20,
      "type": 0
    }
  ],
  "nextTurnIn": 2000,
  "score": 0,
  "spot": {"q": 10, "r": 20},
  "turnNo": 0
}
```

#### POST /api/move
**Запрос:**
```json
{
  "moves": [
    {
      "ant": "uuid",
      "path": [
        {"q": 10, "r": 20},
        {"q": 11, "r": 20}
      ]
    }
  ]
}
```
```
GET /api/arena возвращает текущее состояние арены для вашей команды. Ответ включает информацию о ваших юнитах, видимых врагах, ресурсах, карте, а также мета-данные раунда.
{
  "ants": [...],        // Список ваших юнитов
  "enemies": [...],     // Видимые враги
  "food": [...],        // Видимые ресурсы
  "home": [...],        // Координаты вашего муравейника
  "map": [...],         // Видимые гексы карты
  "nextTurnIn": 0.0,      // Количество секунд до следующего хода
  "score": 0,           // Текущий счёт команды
  "spot": { ... },      // Координаты основного гекса муравейника
  "turnNo": 0           // Номер текущего хода
}
ants[] — список ваших муравьёв
Каждый объект содержит информацию о текущем состоянии юнита:
id — уникальный идентификатор муравья
type — тип муравья
q, r — координаты гекса
health — текущее количество жизней
food — ресурс, который несёт муравей (amount, type)
lastMove[] — маршрут, по которому юнит передвигался в предыдущий ход
move[] — маршрут, заданный на текущий ход
lastAttack — координаты, по которым была совершена последняя атака
lastEnemyAnt — ID вражеского муравья, по которому нанесён урон
enemies[] — видимые вражеские муравьи
Каждый объект содержит:
type, q, r, health, food, attack — известная информация о противнике, если он попал в обзор
food[] — ресурсы на карте
q, r — координаты гекса
type — тип ресурса
amount — количество ресурса на клетке
home[] — координаты всех трёх гексов муравейника вашей команды
map[] — видимые гексы карты
Каждый объект:
q, r — координаты гекса
type — тип гекса
cost — стоимость перемещения на гекс
spot — координаты основного (центрального) гекса муравейника
nextTurnIn — сколько секунд осталось до следующего хода
turnNo — номер текущего хода в раунде
```

### Конфигурация
```python
# В main.py
SERVER_URL = "https://games-test.datsteam.dev/"
TOKEN = "63bf8b86-1505-4f25-b160-27342aa20c58"
```
### Заголовки: 
```
Accept: application/json
X-Auth-Token: token
Content-Type: application/json
```

### Файловая структура
```
datspulse_bot/
├── api_handler.py    # Работа с API
├── brain.py          # Логика алгоритма
├── main.py           # Основной контроллер
```

