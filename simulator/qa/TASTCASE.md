### Детальные Тест-кейсы для Игрового Сервера

---
---
#### **Модуль 1: Инициализация игры (POST /init)**
---
---
**TC-01: Успешная инициализация с валидными параметрами**  
- **Предусловия**: Сервер запущен, сервер неинициализирован  
- **Шаги**:  
  1. Отправить POST /init с параметрами:  
     `field_size=20, npc_count=30, resource_count=30, obstacle_percent=30, npc_movement=true, agent_vision_radius=10`  
- **Ожидаемый результат**:  
  - HTTP 200 OK  
  - `{"status":"game_initialized"}`  
  - Корректное создание игрового поля 

---
**TC-02: Граничные значения размера поля (максимум)** 
- **Предусловия**: Сервер запущен, сервер неинициализирован 
- **Шаги**:  
  1. Отправить POST /init с `field_size=1000, npc_count=30, resource_count=30, obstacle_percent=30, npc_movement=true, agent_vision_radius=10`  
- **Ожидаемый результат**:
  - HTTP 200 OK  
  - `{"status":"game_initialized"}`  
  - Корректное создание игрового поля 
  
---
**TC-03: Невалидный размер поля** 
- **Предусловия**: Сервер запущен, сервер неинициализирован  
- **Шаги**:  
  1. Отправить POST /init с `field_size=5, npc_count=30, resource_count=30, obstacle_percent=30,npc_movement=true, agent_vision_radius=10` 
- **Ожидаемый результат**:  
  - HTTP 400 Bad Request  
  - `{"error": "invalid_params", "details": [...]}`  

---
**TC-04: Превышение лимита NPC**
- **Предусловия**: Сервер запущен, сервер неинициализирован   
- **Шаги**:  
  1. Для поля 50x50 отправить `npc_count=2600`
  Отправить POST /init с `field_size=20, npc_count=2600, resource_count=30, obstacle_percent=30,npc_movement=true, agent_vision_radius=10`  
- **Ожидаемый результат**: HTTP 400 с ошибкой
`{"error": "invalid_params", "details": [...]}`
---
---
#### **Модуль 2: Перемещение агента (POST /command)**
---
---
**TC-05: Успешное перемещение в свободную клетку**  
- **Предусловия**: Игра инициализирована, агент в (5,5) e.g. 
- **Шаги**:  
  1. Отправить `{"command":"move","direction":"right"}` or "left", "down", "up" e.g.
- **Ожидаемый результат**:  
  - Позиция агента: (6,5) e.g. 
  - Очки без изменений 
---
**TC-06: Столкновение с препятствием**  
- **Предусловия**: Препятствие в (5,6) e.g.
- **Шаги**:  
  1. Отправить `{"command":"move","direction":"down"}` or "left", "down", "up" e.g.
- **Ожидаемый результат**:  
  - Респавн агента  
  - -10 очков  
  - Счетчик респавнов +1  
---
**TC-07: Выход за границы поля**  
- **Предусловия**: Агент в (0,0) e.g.
- **Шаги**:  
  1. Отправить `{"command":"move","direction":"up"}` or "left", "down", "up" e.g.
- **Ожидаемый результат**: Респавн с штрафом -10 очков  

---
---
#### **Модуль 3: Механики атаки**
---
---

**TC-08: Атака без NPC в радиусе**  
- **Предусловия**: NPC нет в соседних клетках
- **Шаги**:  
  1. Отправить `{"command":"attack"}`  
- **Ожидаемый результат**: 
  - Очки без изменений  

---

**TC-09: Убийство одного NPC**  
- **Предусловия**: NPC в соседней клетки  
- **Шаги**:  
  1. Отправить `{"command":"attack"}`  
- **Ожидаемый результат**:  
  - +10 очков  
  - NPC удален с поля  

---

**TC-10: Атака по диагонале**  
- **Предусловия**: NPC в диагональной клетки 
- **Шаги**:  
  1. Отправить `{"command":"attack"}`  
- **Ожидаемый результат**: 
  - NPC не поражен  

---
---
#### **Модуль 4: Движение NPC**
---
---

**TC-11: Движение NPC при включенном флаге**  
- **Предусловия**: `npc_movement=true`  
- **Шаги**:  
  1. Отправить любую команду  
- **Ожидаемый результат**: 
  - Позиция NPC изменилась  

---

**TC-12: Движение NPC при выключенном флаге**  
- **Предусловия**: `npc_movement=false` 
- **Шаги**:  
  1. Отправить любую команду  
- **Ожидаемый результат**: 
  - NPC остался на месте  

---
---
#### **Модуль 5: Система ресурсов**
---
---

**TC-13: Сбор ресурса**  
- **Предусловия**: Ресурс в (6,5), агент в (5,5) e.g.
- **Шаги**:  
  1. Отправить `{"command":"move","direction":"right"}`  or "left", "down", "up" e.g.
- **Ожидаемый результат**:  
  - +5 очков  
  - Ресурс удален 

---

**TC-14: Респавн на клетке с ресурсом**  
- **Предусловия**: Ресурс в точке респавна  
- **Шаги**:  
  1. Вызвать респавн агента  
- **Ожидаемый результат**: 
  - Ресурс остается на поле  

---
---
#### **Модуль 6: Система видимости**
---
---

**TC-15: Границы радиуса видимости**  
- **Предусловия**: `agent_vision_radius=5`  
- **Шаги**:  
  1. Проверить наличие обьектов в пределах видимости  
- **Ожидаемый результат**:
  - Объект виден  

---

**TC-16: Объекты вне радиуса видимости**  
- **Шаги**:  
  1. Проверить наличие обьектов за пределами видимости    
- **Ожидаемый результат**: 
  - Объект не виден  

---
---
#### **Модуль 7: Запросы состояния**
---
---

**TC-17: Получение полного состояния**  
- **Шаги**:  
  1. GET /full-state  
- **Ожидаемый результат**:  
  - HTTP 200 OK  
  - Полная карта всех объектов  

---

**TC-18: Статус сервера до инициализации**
- **Предусловия**: Сервер запущен, сервер неинициализирован   
- **Шаги**:  
  1. GET /status  
- **Ожидаемый результат**: 
  - `{"status":"not initialized"}`  

---
---
#### **Модуль 8: Обработка ошибок**
---
---

**TC-19: Команда без инициализации**
- **Предусловия**: Сервер запущен, сервер неинициализирован   
- **Шаги**:  
  1. POST /command до /init  
- **Ожидаемый результат**: 
  - HTTP 404  

---

**TC-20: Неверный метод для /command**  
- **Шаги**:  
  1. Отправить GET /command  
- **Ожидаемый результат**: 
  - HTTP 400  

---
---
#### **Модуль 9: Пограничные сценарии**
---
---

**TC-21: Одновременный сбор ресурса и атака**  
- **Предусловия**: Агент на ресурсе + NPC рядом  
- **Шаги**:  
  1. Отправить `{"command":"attack"}`  
- **Ожидаемый результат**:  
  - Ресурс остается  
  - NPC уничтожены  
  +10 очков за каждого NPC  

---

**TC-22: Максимальная загрузка сервера**  
- **Предусловия**: `field_size=100`, `npc_count=1000`  
- **Шаги**:  
  1. Выполнить 10 последовательных команд  
- **Ожидаемый результат**: 
  - Стабильное время отклика <1 сек  

---
---
#### **Модуль 10: Детерминированность**
---
---

**TC-23: Идентичный seed** 
- **Предусловия**: Сервер запущен, сервер неинициализирован  
- **Шаги**:  
  1. Инициализировать игру с seed=123  
  2. Выполнить последовательность команд  
  3. Перезапустить сервер  
  4. Повторить с теми же параметрами  
- **Ожидаемый результат**: 
  - Идентичное состояние после каждой команды 

---
---
